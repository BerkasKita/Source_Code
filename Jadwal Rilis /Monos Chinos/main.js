// RasganeJS
//class BloggerScript{constructor(t={}){this._config=t}err(t){return console.log(t),t}createRT(t){let e="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=r.length;for(let n=0;n<t;n++)e+=r.charAt(Math.floor(Math.random()*s));return e}resizeImage(t,e=!1){if(!e)return t;let r=/\/(s|w|h)\d{1,4}-((w|s|h)(\d{1,4})+-)?(c{1,2}|p-k-no-nu|rw)/gi,s=/\=(s|w|h)\d{1,4}-((w|s|h)(\d{1,4})+-)?(c{1,2}|p-k-no-nu|rw)/gi,n=/\-(rw)$/.test(e);return n&&(t=t.replace(/\.(gif|jpe?g|tiff?|png|bmp)$/,".webp")),t.match(r)?t.replace(r,`/${e}`):t.match(s)?t.replace(s,`=${e}`):t}shuffle(t){var e,r,s=t.length;if(0===s)return!1;for(;--s;)e=Math.floor(Math.random()*(s+1)),r=t[s],t[s]=t[e],t[e]=r;return t}shuffle2(t,e){return Math.floor(Math.random()*(e-t))+t}sort(t,e){if("Update"==e||"Added"==e){let r="Update"==e?"updated":"published";t=t.sort(function(t,e){return t[r]<e[r]?-1:t[r]>e[r]?1:0}).reverse()}else"A-Z"!=e&&"Z-A"!=e||(t=t.sort((t,e)=>t.title.localeCompare(e.title,void 0,{numeric:!0})),"Z-A"==e&&(t=t.reverse()));return t}xhr(t,e=this.err){let r=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.onreadystatechange=function(){if(4==this.readyState&&200==this.status||304==this.status){let t=this.responseText,r=JSON.parse(t.substring(t.indexOf("{"),t.lastIndexOf("}")+1));e&&e(r)}else 4==this.readyState&&e&&e({})},r.open("GET",t,!0),r.send()}xhr2(t,e=this.err){let r=document.createElement("script"),s="xhr2"+this.createRT(7);return window[s]=function(t){return e(t)},r.src=`${t}&callback=window.${s}`,r.onerror=function(t){console.log(t),e({})},r.async=!0,(document.body||document.getElementsByTagName("body")[0]).appendChild(r)}getImage(t){if("media$thumbnail"in t)return this.resizeImage(t.media$thumbnail.url,this._config.sizeImage);if("content"in t){let e=t.content.$t,r=e.indexOf("<img"),s=e.indexOf('src="',r),n=e.indexOf('"',s+5),i=e.substr(s+5,n-s-5);return-1!=r&&-1!=s&&-1!=n&&""!=i?i:this._config.noImage||""}return this._config.noImage||""}getTime(t){if(/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/.test(t)){var e=t,r=e.substring(0,4),s=e.substring(5,7),n=e.substring(8,10),i=new Array;return i[1]="Jan",i[2]="Feb",i[3]="Mar",i[4]="Apr",i[5]="May",i[6]="Jun",i[7]="Jul",i[8]="Aug",i[9]="Sep",i[10]="Oct",i[11]="Nov",i[12]="Dec",n+" "+i[parseInt(s,10)]+" "+r}return!1}getFeed(t){let e=new Array;if(t.feed&&t.feed.entry)for(let r=0;r<t.feed.entry.length;r++){const s=t.feed.entry[r];let n={};n.id=s.id.$t.split('.post-')[1],n.title=s.title.$t,n.link=s.link.find(t=>"alternate"==t.rel).href,n.enclosure=s.link.filter(e=>"enclosure"==e.rel).map(e=>({href:e.href,type:e.type})),n.image=this.getImage(s),n.label=s.category?.map(t=>t.term)||[],n.date=this.getTime(s.published.$t),n.published=s.published.$t,n.updated=s.updated.$t,"summary"in s&&(n.summary=s.summary.$t),"content"in s&&(n.content=s.content.$t),"author"in s&&(n.author=s.author[0]),e.push(n)}return e}}class BloggerRandom extends BloggerScript{constructor(t={}){super(t)}getTotalResults(t){let e=t.feed.openSearch$totalResults.$t,r=this._config.jumlah;if(r){if(e<r)return!1;e=this.shuffle2(1,e-r)}else e=e<=150?1:this.shuffle2(1,e-150),r=150;return{"start-index":e,"max-results":r}}getItems(t){if("entry"in t.feed){let e=this.getFeed(t);return e=this.shuffle(e),e}return[]}run(t,e=this.err,r=!0){let s=this,n=r?"xhr":"xhr2";s[n](`${t}?alt=json-in-script&max-results=0`,r=>{let i=s.getTotalResults(r);s[n](`${t}?alt=json-in-script&start-index=${i["start-index"]}&max-results=${i["max-results"]}`,t=>{e(s.getItems(t))})})}}class BloggerRelated extends BloggerScript{constructor(t={}){super(t)}run(t,e=this.err,r=!0){let s=this,n=0,i=document.location.pathname,a=s._config.labels,o=s._config.jumlah,l=r?"xhr":"xhr2";if(s._config.arr=new Array,"undefined"==a||""==a||0==a.length)return e([]);a.forEach(r=>{s[l](`${t}/-/${r}?alt=json-in-script&max-results=${o}`,t=>{let r=s.getFeed(t);if(r.forEach(t=>{s._config.arr.some(e=>e.id==t.id)||s._config.arr.push(t)}),n++,n==a.length){if(0==s._config.arr.length)return e([]);let t=s._config.arr.map(t=>new URL(t.link).pathname==i).indexOf(!0);s._config.arr.splice(t,1);let r=s.shuffle(s._config.arr).slice(0,o);return e(r)}})})}}class BloggerSitemap extends BloggerScript{constructor(t){super(t),this._settings={"start-index":1,"max-results":150,"total-get":0,posts:new Array}}alphaSort(t){let e=new Array,r=new Array,s="";0!=t.length&&this.sort(t,"A-Z").forEach(t=>{let r=t.title.charAt(0).toLowerCase();-1==s.indexOf(r)?(s+=r,e[r]=[t]):e[r].push(t)});for(const t in e)if(Object.hasOwnProperty.call(e,t)){const s=e[t];r.push({id:t,items:s})}return r}run(t,e=this.err,r=!0){const s=this._settings,n=this._config,i=n.order||"updated",a=`${t}?alt=json-in-script&start-index=${s["start-index"]}&max-results=${s["max-results"]}&orderby=${i}`,o=i=>{if("entry"in i.feed){let a=i.feed.openSearch$totalResults.$t||0;Array.prototype.push.apply(s.posts,this.getFeed(i)),i.feed.entry.length>=s["max-results"]?(s["start-index"]+=s["max-results"],n.firstContent&&1==s["total-get"]&&e(s.posts,s["total-get"],!1,a),this.run(t,e,r)):e(s.posts,s["total-get"],!0,a)}else e(s.posts,s["total-get"],!0,s.posts.length)},l=r?"xhr":"xhr2";s["total-get"]++,this[l](a,o)}};function get_moveElement(e,t,o){let n=document.querySelector(e),c=document.querySelector(t);c&&(n?c.appendChild(n):c.innerHTML=o)}function get_moveElement2(e,t){let o=document.querySelector(e),n=document.querySelector(t);n&&(o?n.appendChild(o):n.remove())}async function showLucky(e){try{const t=e.feed,o=(t.entry,t.entry[0]);if(!o)return void console.log("No Post!!");for(let e=0;e<o.link.length;++e)if("alternate"===o.link[e].rel)return void(window.location=o.link[e].href)}catch(e){console.log("An error occurred:",e.message)}}async function fetchLuck(e,t){try{const o=t?`/-/${t}`:"",n=await fetch(`/feeds/posts/summary${o}?start-index=${e}&max-results=1&alt=json`),c=await n.json();await showLucky(c)}catch(e){console.log("An error occurred:",e.message)}}async function readLucky(e,t){try{const o=e.feed,n=parseInt(o.openSearch$totalResults.$t,10);if(!n)return void console.log("No Posts available!!");const c=Math.floor(Math.random()*n)+1;await fetchLuck(c,t)}catch(e){console.log("An error occurred:",e.message)}}async function feelingLucky(e){try{const t=e?`/-/${e}`:"",o=await fetch(`/feeds/posts/summary${t}?max-results=0&alt=json`),n=await o.json();await readLucky(n,e)}catch(e){console.log("An error occurred:",e.message)}}function get_random(e,t){e&&document.querySelector(e).addEventListener("click",()=>{feelingLucky(t)})}function get_up_button(e,t){const o=document.querySelector(e);o&&(o.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}),t&&window.addEventListener("scroll",function(){window.scrollY>100?o.classList.add(t):o.classList.remove(t)}))}function get_year(e){const t=document.querySelector(e);if(t){const e=(new Date).getFullYear();t.innerHTML=e}};const get_tabs=()=>{document.querySelectorAll("nav[data-tabs]").forEach(function(t){t.querySelectorAll(".tab_cp__").forEach(function(e){e.addEventListener("click",function(){const e=this.getAttribute("data-name"),a=t.getAttribute("data-tabs");t.querySelectorAll(".tab_cp__").forEach(function(t){t.classList.remove("active")}),document.querySelectorAll(a).forEach(function(t){t.classList.remove("active"),t.style.display="none"}),this.classList.add("active");const c=document.querySelector(a+'[data-name="'+e+'"]');c.classList.add("active"),c.style.display="block"})})})};const get_TimeAgo=e=>{const t=new Date(e),o=new Date,n=Math.floor((o-t)/1e3),s=[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60}];for(const{label:e,seconds:t}of s){const o=Math.floor(n/t);if(o>=1)return`${o} ${e}${1!==o?"s":""} ago`}return`${n} second${1!==n?"s":""} ago`},get_updateTimes=()=>{document.querySelectorAll(".time").forEach(e=>{const t=e.getAttribute("datetime")||e.textContent,o=get_TimeAgo(t);e.textContent=o})};function get_klik(t,i,s){const n=document.querySelector(i),e=document.querySelector(s);n&&e?n.addEventListener("click",function(){t.startsWith(".")?e.classList.toggle(t.substring(1)):t.startsWith("#")&&(e.id===t.substring(1)?e.id="":e.id=t.substring(1))}):console.error("Elemen tidak ditemukan. Pastikan class/id yang diberikan benar.")}function get_klik2(t,s,i){const e=document.querySelector(s),n=document.querySelector(i);e&&n?(e.addEventListener("click",function(s){s.stopPropagation();const i=document.querySelector("#page-panel"),e=document.querySelector("#number-panel"),r=document.querySelector("#comment-panel");i&&i!==n&&(t.startsWith(".")?i.classList.remove(t.substring(1)):t.startsWith("#")&&i.id===t.substring(1)&&(i.id="")),e&&e!==n&&(t.startsWith(".")?e.classList.remove(t.substring(1)):t.startsWith("#")&&e.id===t.substring(1)&&(e.id="")),r&&r!==n&&(t.startsWith(".")?r.classList.remove(t.substring(1)):t.startsWith("#")&&r.id===t.substring(1)&&(r.id="")),t.startsWith(".")?n.classList.toggle(t.substring(1)):t.startsWith("#")&&(n.id===t.substring(1)?n.id="":n.id=t.substring(1))}),document.addEventListener("click",function(s){e.contains(s.target)||n.contains(s.target)||(t.startsWith(".")?n.classList.remove(t.substring(1)):t.startsWith("#")&&n.id===t.substring(1)&&(n.id=""))})):console.error("Elemen tidak ditemukan. Pastikan class/id yang diberikan benar.")}function get_comment(e,t){if("disqus"===e){if(!page__url)return void console.error("Error: page__url tidak tersedia.");if(!page__id)return void console.error("Error: page__id tidak tersedia.");if(!disqus_shortname)return void console.error("Error: disqus_shortname tidak tersedia.");if("click"===t){const e=e=>{if(e&&e.target&&!e.target.classList.contains("loaded")){e.target.innerText="Loading...";let t=document.createElement("script");t.src=`//${disqus_shortname}.disqus.com/embed.js`,document.body.appendChild(t),e.target.classList.add("loaded")}};let t=document.querySelector("#comments");if(t){t.innerHTML="";let s=document.createElement("div");s.className="bt_disqus",s.id="disqus_thread",s.innerText="Show Comment",t.appendChild(s),t.classList.remove("none");s.addEventListener("click",e)}}else if("viewport"===t){let e=document.querySelector("#comments");if(e){e.innerHTML="";let t=document.createElement("div");t.className="bt_disqus loaded",t.id="disqus_thread",t.innerText="Loading...",e.appendChild(t),e.classList.remove("none");const s=()=>{if(document.getElementById("disqus_thread"))if(void 0===window.DISQUS){var e=document.createElement("script");e.src=`//${disqus_shortname}.disqus.com/embed.js`,e.setAttribute("data-timestamp",+new Date),(document.head||document.body).appendChild(e)}else window.DISQUS.reset({reload:!0,config:function(){this.page.identifier=page__id,this.page.url=page__url}})},i=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(s(),t.unobserve(e.target))})},{root:null,rootMargin:"0px",threshold:.1}),d=document.getElementById("disqus_thread");d&&i.observe(d)}}}else if("blogger"===e){let e=document.querySelector("#comments");e&&e.classList.remove("none")}}function get_comment(e,t){if("disqus"===e){if(!page__url||!page__id||!disqus_shortname)return void console.error("Error: page__url, page__id, atau disqus_shortname tidak tersedia.");if("click"===t){const e=e=>{if(e&&e.target&&!e.target.classList.contains("loaded")){e.target.innerText="Loading...";let t=document.createElement("script");t.src=`//${disqus_shortname}.disqus.com/embed.js`,document.body.appendChild(t),e.target.classList.add("loaded")}};let t=document.querySelector("#comments");if(t){t.innerHTML="";let s=document.createElement("div");s.className="bt_disqus",s.id="disqus_thread",s.innerText="Show Comment",t.appendChild(s),t.classList.remove("none");s.addEventListener("click",e)}}else if("viewport"===t){let e=document.querySelector("#comments");if(e){e.innerHTML="";let t=document.createElement("div");t.className="bt_disqus loaded",t.id="disqus_thread",t.innerText="Loading...",e.appendChild(t),e.classList.remove("none");const s=()=>{if(document.getElementById("disqus_thread"))if(void 0===window.DISQUS){var e=document.createElement("script");e.src=`//${disqus_shortname}.disqus.com/embed.js`,e.setAttribute("data-timestamp",+new Date),(document.head||document.body).appendChild(e)}else window.DISQUS.reset({reload:!0,config:function(){this.page.identifier=page__id,this.page.url=page__url}})},i=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(s(),t.unobserve(e.target))})},{root:null,rootMargin:"0px",threshold:.1}),d=document.getElementById("disqus_thread");d&&i.observe(d)}}}else if("blogger"===e){let e=document.querySelector("#comments");e&&e.classList.remove("none")}}

// BloggerScript https://www.dayat.id/2022/07/bloggerscript-javascript-library-khusus.html
"use strict";class BloggerScript{constructor(a={}){this.config=a,this._siteMap={arr:new Array,callback:"undefined",fc:"function",max:150,start:1,url:"url"}}siteMap(b,c=function(a){console.log(a)}){let a=this;a.xhr("GET",`${b}?alt=json-in-script&start-index=${a._siteMap.start}&max-results=${a._siteMap.max}`,function(d){if("entry"in d.feed){let e=d.feed.entry;Array.prototype.push.apply(a._siteMap.arr,a.getFeed(d)),e.length>=a._siteMap.max?(a._siteMap.start+=a._siteMap.max,a.siteMap(b,c)):c(a._siteMap.arr)}else c(a._siteMap.arr)})}getFeed(a){if(a.feed.entry){let b=new Array;return a.feed.entry.forEach(a=>{let c={};c.title=a.title.$t,c.link=this.getLink(a.link),c.image=this.getImage(a),c.label=this.getLabel(a.category),c.date=this.getTime(a.published.$t),c.published=a.published.$t,c.updated=a.updated.$t,"summary"in a&&(c.summary=a.summary.$t),"content"in a&&(c.content=a.content.$t),"author"in a&&(c.author=this.getAuthor(a)),b.push(c)}),b}return[]}getImage(a){if("media$thumbnail"in a)return this.resizeImage(a.media$thumbnail.url);if(!("content"in a))return this.config.noImage||"";{let b=a.content.$t,d=b.indexOf("<img"),c=b.indexOf('src="',d),e=b.indexOf('"',c+5),f=b.substr(c+5,e-c-5);return -1!=d&& -1!=c&& -1!=e&&""!=f?f:this.config.noImage||""}}getAuthor(a){var b,c,d,e,f,g;return{name:(null===(b=a.author[0])|| void 0===b?void 0:null===(c=b.name)|| void 0===c?void 0:c.$t)||"",link:(null===(d=a.author[0])|| void 0===d?void 0:null===(e=d.uri)|| void 0===e?void 0:e.$t)||"",image:(null===(f=a.author[0])|| void 0===f?void 0:null===(g=f.gd$image)|| void 0===g?void 0:g.src)||""}}getLink(a){return a.find(a=>"alternate"==a.rel).href}getLabel(a){return a.map(a=>a.term)}getTime(c){if(/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/.test(c)){var b=c,d=b.substring(0,4),e=b.substring(5,7),f=b.substring(8,10),a=new Array;return a[1]="Jan",a[2]="Feb",a[3]="Mar",a[4]="Apr",a[5]="May",a[6]="Jun",a[7]="Jul",a[8]="Aug",a[9]="Sep",a[10]="Oct",a[11]="Nov",a[12]="Dec",f+" "+a[parseInt(e,10)]+" "+d}return!1}resizeImage(a){return this.config.sizeImage?a.match(/\/s[0-9]{2}-(w[0-9]+-)?c/)?a.replace(/\/s[0-9]{2}-(w[0-9]+-)?c/,`/${this.config.sizeImage}`):a.replace(/\=s[0-9]{2}-(w[0-9]+-)?c/,`=${this.config.sizeImage}`):a}relatedPost(b=function(a){console.log(a)}){let a=this,c=0,d=new Array,e=document.location.pathname;"undefined"!=a.config.label&&""!=a.config.label&&0!=a.config.label.length&&a.config.label.forEach(f=>{a.xhr("GET",`/feeds/posts/default/-/${f.replace(/\&amp;/g,"&").replace(/\//g,"%2F")}?alt=json-in-script&max-results=${a.config.jumlah}`,function(g){if("entry"in g.feed&&a.getFeed(g).forEach(a=>{!a.link.includes(e)&&(d.some(b=>b.link==a.link)||d.push(a))}),++c==a.config.label.length){if(0==d.length)return!1;let f=a.shuffle(d);return f.length>a.config.jumlah&&(f=f.slice(0,a.config.jumlah)),b(f)}})})}randomPost(b,c=function(a){console.log(a)}){let a=this,d=a.config.jumlah;a.xhr("GET",`${b}?alt=json-in-script&max-results=0`,function(f){let e=f.feed.openSearch$totalResults.$t;if(a.config.allRandom)e=e<=150?1:a.shuffle2(1,e-150),d=150;else{if(e<a.config.jumlah)return;e=a.shuffle2(1,e-a.config.jumlah)}a.xhr("GET",`${b}?alt=json-in-script&start-index=${e}&max-results=${d}`,function(b){if("entry"in b.feed){let d=a.getFeed(b);return c(d=a.shuffle(d))}})})}shuffle(a){var c,d,b=a.length;if(0===b)return!1;for(;--b;)c=Math.floor(Math.random()*(b+1)),d=a[b],a[b]=a[c],a[c]=d;return a}shuffle2(a,b){return Math.floor(Math.random()*(b-a))+a}xhr(b,c,d){let a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.onreadystatechange=function(){if(4==this.readyState&&200==this.status||304==this.status){let a=this.responseText,b=JSON.parse(a.substring(a.indexOf("{"),a.lastIndexOf("}")+1));d&&d(b)}},a.onerror=a=>console.log(a),a.open(b,c,!0),a.send()}inTag(b){let a=document.createElement("script");a.src=b,document.body.appendChild(a)}}

let days = ['Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu', 'Minggu'];

let cp_schedule = new BloggerScript({
  noImage: "https://1.bp.blogspot.com/-XSp30PahyTM/YK37Rq_-M7I/AAAAAAAABCc/01K0sUhw-2YI7vr48wqMIAVoMLDEUdK2gCLcBGAsYHQ/s2048/No%2BImage%2BBerkas%2BKita.jpg",
  sizeImage: 's320'
});

const get_cp_schedule = (e) => {
  let get_location = document.querySelector('.box_schedule');
  let entry = cp_schedule.getFeed(e);

  let groupedEntries = {};
  days.forEach(day => {
    groupedEntries[day] = entry.filter(entry => entry.label.includes(day));
  });
  console.log(groupedEntries);
  let ulContent = '';
  let tabContent = '';

  days.forEach((day, index) => {
    ulContent += `<li class="nav-item" data-post="${index + 1}">${day}</li>`;

    let entriesHtml = '';
    groupedEntries[day].forEach(item => {
      let eps = item.label.find(i => ["Episode","Eps.","Ep"].some(s => i.includes(s)));
      entriesHtml += `
        <a href="${item.link}">
          <div class="box_artikel">
            <div class="thumb">
              <img src="${item.image}" alt="${item.title}">
              ${eps?`<div class="eps"><span>${eps}</span></div>`:''}
            </div>
            <h3>${item.title}</h3>
          </div>
        </a>`;
    });
    if (entriesHtml === '') {
      entriesHtml = `<span class="no_data">No Post...</span>`;
    }
    tabContent += `<div class="tab-pane" data-post="${index + 1}">${entriesHtml}</div>`;
  });
  if (get_location) {
    get_location.innerHTML = `<ul>${ulContent}</ul><div class="tab-content">${tabContent}</div>`;

    // Add event listener for tab switching
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function() {
        document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
        document.querySelector('.tab-pane[data-post="' + this.getAttribute('data-post') + '"]').classList.add('active');

        document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // Set the active tab based on the current day
    let today = new Date().getDay(); // 0 = Sunday, 1 = Monday, ..., 6 = Saturday
    let dayIndex = today === 0 ? 6 : today - 1; // Adjust the index to match the days array (0 = Senin, ..., 6 = Minggu)
    console.log(today);
    
    document.querySelectorAll('.nav-item')[dayIndex].classList.add('active');
    document.querySelectorAll('.tab-pane')[dayIndex].classList.add('active');
  }
};

const run_cp_schedule = () => {
  let get_location = document.querySelector('.box_schedule');
  if (get_location) {
    let label_name = get_location.dataset.label || false;
    cp_schedule.xhr2(`https://onistream-jgggg.blogspot.com/feeds/posts/default${label_name == false ? '' : `/-/${label_name}`}?alt=json-in-script&max-results=150`, get_cp_schedule);
  }
};

document.addEventListener('DOMContentLoaded', () => {
  run_cp_schedule();
});
